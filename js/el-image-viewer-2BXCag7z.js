import{aA as U,aH as Se,U as ie,T as xe,d as we,e as G,at as he,h as de,j as le,aI as ge,aJ as Ce,aK as Te,an as be,u as ke,aL as ze,r as C,aM as Ne,aN as Oe,k as _,w as fe,G as Ie,l as _e,o as x,t as me,a as p,v as $,n as S,q as h,p as t,C as ve,D as Re,y as A,E as Y,aO as $e,c as B,ag as oe,aP as Ae,aQ as Be,aR as Me,aS as Ve,x as Xe,aT as Ye,aU as De,am as Fe,ar as Pe,as as We,B as re,ay as He,aV as je,F as Ee,aW as q,aX as K,aY as Ke,J as Le,aZ as Ue,a_ as qe,aq as Ze,a$ as Ge,g as Je,z as Qe}from"./index-BnB9npJL.js";import{o as et,p as tt}from"./request-Cs-5J-qA.js";const at=(e,i)=>{if(!U||!e||!i)return!1;const s=e.getBoundingClientRect();let c;return i instanceof Element?c=i.getBoundingClientRect():c={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},s.top<c.bottom&&s.bottom>c.top&&s.right>c.left&&s.left<c.right};var nt=/\s/;function st(e){for(var i=e.length;i--&&nt.test(e.charAt(i)););return i}var rt=/^\s+/;function it(e){return e&&e.slice(0,st(e)+1).replace(rt,"")}var pe=NaN,ot=/^[-+]0x[0-9a-f]+$/i,lt=/^0b[01]+$/i,ut=/^0o[0-7]+$/i,ct=parseInt;function ye(e){if(typeof e=="number")return e;if(Se(e))return pe;if(ie(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ie(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=it(e);var s=lt.test(e);return s||ut.test(e)?ct(e.slice(2),s?2:8):ot.test(e)?pe:+e}var ue=function(){return xe.Date.now()},dt="Expected a function",ft=Math.max,mt=Math.min;function vt(e,i,s){var c,l,v,O,r,I,y=0,E=!1,L=!1,w=!0;if(typeof e!="function")throw new TypeError(dt);i=ye(i)||0,ie(s)&&(E=!!s.leading,L="maxWait"in s,v=L?ft(ye(s.maxWait)||0,i):v,w="trailing"in s?!!s.trailing:w);function f(u){var b=c,T=l;return c=l=void 0,y=u,O=e.apply(T,b),O}function M(u){return y=u,r=setTimeout(X,i),E?f(u):O}function d(u){var b=u-I,T=u-y,H=i-b;return L?mt(H,v-T):H}function V(u){var b=u-I,T=u-y;return I===void 0||b>=i||b<0||L&&T>=v}function X(){var u=ue();if(V(u))return D(u);r=setTimeout(X,d(u))}function D(u){return r=void 0,w&&c?f(u):(c=l=void 0,O)}function W(){r!==void 0&&clearTimeout(r),y=0,c=I=l=r=void 0}function F(){return r===void 0?O:D(ue())}function P(){var u=ue(),b=V(u);if(c=arguments,l=this,I=u,b){if(r===void 0)return M(I);if(L)return clearTimeout(r),r=setTimeout(X,i),f(I)}return r===void 0&&(r=setTimeout(X,i)),O}return P.cancel=W,P.flush=F,P}var gt="Expected a function";function ce(e,i,s){var c=!0,l=!0;if(typeof e!="function")throw new TypeError(gt);return ie(s)&&(c="leading"in s?!!s.leading:c,l="trailing"in s?!!s.trailing:l),vt(e,i,{leading:c,maxWait:i,trailing:l})}const pt=we({urlList:{type:G(Array),default:()=>he([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:G(String)}}),yt={close:()=>!0,switch:e=>de(e),rotate:e=>de(e)},wt=["src","crossorigin"],ht=le({name:"ElImageViewer"}),bt=le({...ht,props:pt,emits:yt,setup(e,{expose:i,emit:s}){var c;const l=e,v={CONTAIN:{name:"contain",icon:ge(Ce)},ORIGINAL:{name:"original",icon:ge(Te)}},{t:O}=be(),r=ke("image-viewer"),{nextZIndex:I}=ze(),y=C(),E=C([]),L=Ne(),w=C(!0),f=C(l.initialIndex),M=Oe(v.CONTAIN),d=C({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),V=C((c=l.zIndex)!=null?c:I()),X=_(()=>{const{urlList:n}=l;return n.length<=1}),D=_(()=>f.value===0),W=_(()=>f.value===l.urlList.length-1),F=_(()=>l.urlList[f.value]),P=_(()=>[r.e("btn"),r.e("prev"),r.is("disabled",!l.infinite&&D.value)]),u=_(()=>[r.e("btn"),r.e("next"),r.is("disabled",!l.infinite&&W.value)]),b=_(()=>{const{scale:n,deg:o,offsetX:m,offsetY:z,enableTransition:R}=d.value;let k=m/n,N=z/n;switch(o%360){case 90:case-270:[k,N]=[N,-k];break;case 180:case-180:[k,N]=[-k,-N];break;case 270:case-90:[k,N]=[-N,k];break}const j={transform:`scale(${n}) rotate(${o}deg) translate(${k}px, ${N}px)`,transition:R?"transform .3s":""};return M.value.name===v.CONTAIN.name&&(j.maxWidth=j.maxHeight="100%"),j});function T(){J(),s("close")}function H(){const n=ce(m=>{switch(m.code){case K.esc:l.closeOnPressEscape&&T();break;case K.space:ne();break;case K.left:se();break;case K.up:g("zoomIn");break;case K.right:a();break;case K.down:g("zoomOut");break}}),o=ce(m=>{const z=m.deltaY||m.deltaX;g(z<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})});L.run(()=>{q(document,"keydown",n),q(document,"wheel",o)})}function J(){L.stop()}function Q(){w.value=!1}function ee(n){w.value=!1,n.target.alt=O("el.image.error")}function te(n){if(w.value||n.button!==0||!y.value)return;d.value.enableTransition=!1;const{offsetX:o,offsetY:m}=d.value,z=n.pageX,R=n.pageY,k=ce(j=>{d.value={...d.value,offsetX:o+j.pageX-z,offsetY:m+j.pageY-R}}),N=q(document,"mousemove",k);q(document,"mouseup",()=>{N()}),n.preventDefault()}function ae(){d.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ne(){if(w.value)return;const n=Ke(v),o=Object.values(v),m=M.value.name,R=(o.findIndex(k=>k.name===m)+1)%n.length;M.value=v[n[R]],ae()}function Z(n){const o=l.urlList.length;f.value=(n+o)%o}function se(){D.value&&!l.infinite||Z(f.value-1)}function a(){W.value&&!l.infinite||Z(f.value+1)}function g(n,o={}){if(w.value)return;const{minScale:m,maxScale:z}=l,{zoomRate:R,rotateDeg:k,enableTransition:N}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...o};switch(n){case"zoomOut":d.value.scale>m&&(d.value.scale=Number.parseFloat((d.value.scale/R).toFixed(3)));break;case"zoomIn":d.value.scale<z&&(d.value.scale=Number.parseFloat((d.value.scale*R).toFixed(3)));break;case"clockwise":d.value.deg+=k,s("rotate",d.value.deg);break;case"anticlockwise":d.value.deg-=k,s("rotate",d.value.deg);break}d.value.enableTransition=N}return fe(F,()=>{Ie(()=>{const n=E.value[0];n!=null&&n.complete||(w.value=!0)})}),fe(f,n=>{ae(),s("switch",n)}),_e(()=>{var n,o;H(),(o=(n=y.value)==null?void 0:n.focus)==null||o.call(n)}),i({setActiveItem:Z}),(n,o)=>(x(),me(je,{to:"body",disabled:!n.teleported},[p(He,{name:"viewer-fade",appear:""},{default:$(()=>[S("div",{ref_key:"wrapper",ref:y,tabindex:-1,class:h(t(r).e("wrapper")),style:ve({zIndex:V.value})},[S("div",{class:h(t(r).e("mask")),onClick:o[0]||(o[0]=Re(m=>n.hideOnClickModal&&T(),["self"]))},null,2),A(" CLOSE "),S("span",{class:h([t(r).e("btn"),t(r).e("close")]),onClick:T},[p(t(Y),null,{default:$(()=>[p(t($e))]),_:1})],2),A(" ARROW "),t(X)?A("v-if",!0):(x(),B(oe,{key:0},[S("span",{class:h(t(P)),onClick:se},[p(t(Y),null,{default:$(()=>[p(t(Ae))]),_:1})],2),S("span",{class:h(t(u)),onClick:a},[p(t(Y),null,{default:$(()=>[p(t(Be))]),_:1})],2)],64)),A(" ACTIONS "),S("div",{class:h([t(r).e("btn"),t(r).e("actions")])},[S("div",{class:h(t(r).e("actions__inner"))},[p(t(Y),{onClick:o[1]||(o[1]=m=>g("zoomOut"))},{default:$(()=>[p(t(Me))]),_:1}),p(t(Y),{onClick:o[2]||(o[2]=m=>g("zoomIn"))},{default:$(()=>[p(t(Ve))]),_:1}),S("i",{class:h(t(r).e("actions__divider"))},null,2),p(t(Y),{onClick:ne},{default:$(()=>[(x(),me(Xe(t(M).icon)))]),_:1}),S("i",{class:h(t(r).e("actions__divider"))},null,2),p(t(Y),{onClick:o[3]||(o[3]=m=>g("anticlockwise"))},{default:$(()=>[p(t(Ye))]),_:1}),p(t(Y),{onClick:o[4]||(o[4]=m=>g("clockwise"))},{default:$(()=>[p(t(De))]),_:1})],2)],2),A(" CANVAS "),S("div",{class:h(t(r).e("canvas"))},[(x(!0),B(oe,null,Fe(n.urlList,(m,z)=>Pe((x(),B("img",{ref_for:!0,ref:R=>E.value[z]=R,key:m,src:m,style:ve(t(b)),class:h(t(r).e("img")),crossorigin:n.crossorigin,onLoad:Q,onError:ee,onMousedown:te},null,46,wt)),[[We,z===f.value]])),128))],2),re(n.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var kt=Ee(bt,[["__file","image-viewer.vue"]]);const It=Le(kt),_t=we({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:G([String,Object])},previewSrcList:{type:G(Array),default:()=>he([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:G(String)}}),Et={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>de(e),close:()=>!0,show:()=>!0},Lt=["src","loading","crossorigin"],St={key:0},xt=le({name:"ElImage",inheritAttrs:!1}),Ct=le({...xt,props:_t,emits:Et,setup(e,{emit:i}){const s=e;let c="";const{t:l}=be(),v=ke("image"),O=Ue(),r=et(),I=C(),y=C(!1),E=C(!0),L=C(!1),w=C(),f=C(),M=U&&"loading"in HTMLImageElement.prototype;let d,V;const X=_(()=>[v.e("inner"),F.value&&v.e("preview"),E.value&&v.is("loading")]),D=_(()=>O.style),W=_(()=>{const{fit:a}=s;return U&&a?{objectFit:a}:{}}),F=_(()=>{const{previewSrcList:a}=s;return Array.isArray(a)&&a.length>0}),P=_(()=>{const{previewSrcList:a,initialIndex:g}=s;let n=g;return g>a.length-1&&(n=0),n}),u=_(()=>s.loading==="eager"?!1:!M&&s.loading==="lazy"||s.lazy),b=()=>{U&&(E.value=!0,y.value=!1,I.value=s.src)};function T(a){E.value=!1,y.value=!1,i("load",a)}function H(a){E.value=!1,y.value=!0,i("error",a)}function J(){at(w.value,f.value)&&(b(),te())}const Q=qe(J,200,!0);async function ee(){var a;if(!U)return;await Ie();const{scrollContainer:g}=s;Ge(g)?f.value=g:Je(g)&&g!==""?f.value=(a=document.querySelector(g))!=null?a:void 0:w.value&&(f.value=tt(w.value)),f.value&&(d=q(f,"scroll",Q),setTimeout(()=>J(),100))}function te(){!U||!f.value||!Q||(d==null||d(),f.value=void 0)}function ae(a){if(a.ctrlKey){if(a.deltaY<0)return a.preventDefault(),!1;if(a.deltaY>0)return a.preventDefault(),!1}}function ne(){F.value&&(V=q("wheel",ae,{passive:!1}),c=document.body.style.overflow,document.body.style.overflow="hidden",L.value=!0,i("show"))}function Z(){V==null||V(),document.body.style.overflow=c,L.value=!1,i("close")}function se(a){i("switch",a)}return fe(()=>s.src,()=>{u.value?(E.value=!0,y.value=!1,te(),ee()):b()}),_e(()=>{u.value?ee():b()}),(a,g)=>(x(),B("div",{ref_key:"container",ref:w,class:h([t(v).b(),a.$attrs.class]),style:ve(t(D))},[y.value?re(a.$slots,"error",{key:0},()=>[S("div",{class:h(t(v).e("error"))},Qe(t(l)("el.image.error")),3)]):(x(),B(oe,{key:1},[I.value!==void 0?(x(),B("img",Ze({key:0},t(r),{src:I.value,loading:a.loading,style:t(W),class:t(X),crossorigin:a.crossorigin,onClick:ne,onLoad:T,onError:H}),null,16,Lt)):A("v-if",!0),E.value?(x(),B("div",{key:1,class:h(t(v).e("wrapper"))},[re(a.$slots,"placeholder",{},()=>[S("div",{class:h(t(v).e("placeholder"))},null,2)])],2)):A("v-if",!0)],64)),t(F)?(x(),B(oe,{key:2},[L.value?(x(),me(t(It),{key:0,"z-index":a.zIndex,"initial-index":t(P),infinite:a.infinite,"zoom-rate":a.zoomRate,"min-scale":a.minScale,"max-scale":a.maxScale,"url-list":a.previewSrcList,"hide-on-click-modal":a.hideOnClickModal,teleported:a.previewTeleported,"close-on-press-escape":a.closeOnPressEscape,onClose:Z,onSwitch:se},{default:$(()=>[a.$slots.viewer?(x(),B("div",St,[re(a.$slots,"viewer")])):A("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):A("v-if",!0)],64)):A("v-if",!0)],6))}});var Tt=Ee(Ct,[["__file","image.vue"]]);const Ot=Le(Tt);export{Ot as E};

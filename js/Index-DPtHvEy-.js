import{f as S,n as T}from"./request-Cs-5J-qA.js";import{e as y,_ as k,E as V}from"./exchange-6IrGHGIc.js";import{E as $}from"./el-image-viewer-2BXCag7z.js";/* empty css                  */import{_ as b,K as M,l as P,r as i,Q as m,c as r,a,n as e,z as c,v as p,ag as z,am as A,o as d,N as v,y as D,O as F,P as H}from"./index-BnB9npJL.js";import{_ as K}from"./HeaderBar-Bmgv5a9k.js";import{E}from"./index-Cr4carRk.js";const _=n=>(F("data-v-1ef62c96"),n=n(),H(),n),O={class:"page-wrapper"},Q={class:"flex"},R={class:"left-point-wrap flex"},j=_(()=>e("span",null,"剩余积分：",-1)),q=_(()=>e("img",{class:"icon-coin",src:k},null,-1)),G={class:"product-list flex"},J={class:"card-cover-wrap"},U={key:0,class:"card-limit"},W={class:"card-detail flex"},X={class:"card-price flex"},Y=_(()=>e("img",{class:"icon-coin",src:k},null,-1)),Z={class:"card-stock"},ee=_(()=>e("div",{class:"card-divider"},null,-1)),se={class:"card-footer flex"},te={__name:"Index",setup(n){const w=M();P(async()=>{const s=E.service({fullscreen:!0});await u(),s.close()});const h=i([]),g=i(0),u=async()=>{const s=await y.list();s.code===200?(h.value=s.data.list,g.value=s.data.left_point):m.error(s.msg)},l=i(!1),f=i(0),I=async s=>{l.value||T.confirm(`确认要消耗${s.cost_point}积分兑换【${s.goods_name}】吗？`,"",{confirmButtonText:"确定",cancelButtonText:"取消",center:!0,showClose:!1}).then(async()=>{const x=E.service({fullscreen:!0});f.value=s.goods_id,l.value=!0;const o=await y.exchange({goods_id:s.goods_id});x.close(),o.code===200?(m.success("兑换成功"),u()):(o.code===601&&u(),m.warning(o.msg)),l.value=!1,f.value=0}).catch(()=>{})},B=()=>{w.push("/exchange/history")};return(s,x)=>{const o=S,C=$,L=V;return d(),r("div",O,[a(K,{title:"积分商店"}),e("header",Q,[e("div",R,[j,q,e("span",null,c(g.value),1)]),a(o,{type:"primary",onClick:B},{default:p(()=>[v("兑换记录")]),_:1})]),e("main",null,[e("div",G,[(d(!0),r(z,null,A(h.value,(t,N)=>(d(),r("div",{class:"card",key:N},[e("div",J,[t.limit?(d(),r("div",U,"限兑："+c(t.limit),1)):D("",!0),a(C,{class:"card-cover",src:t.goods_cover,fit:"cover"},null,8,["src"])]),a(L,{class:"card-title",truncated:""},{default:p(()=>[v(c(t.goods_name),1)]),_:2},1024),e("div",W,[e("div",X,[Y,e("span",null,c(t.cost_point),1)]),e("div",Z,"库存："+c(t.left_stock),1)]),ee,e("div",se,[a(o,{style:{width:"100%"},type:"primary",disabled:t.left_stock===0,loading:f.value===t.goods_id&&l.value,onClick:oe=>I(t)},{default:p(()=>[v(" 兑换 ")]),_:2},1032,["disabled","loading","onClick"])])]))),128))])])])}}},_e=b(te,[["__scopeId","data-v-1ef62c96"]]);export{_e as default};
